<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}LearnFlow AI{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        
        /* New Drawer CSS */
        .drawer {
            transform: translateX(100%);
            transition: transform 0.3s ease-out;
        }

        .drawer.open {
            transform: translateX(0);
        }
        
        /* Backdrop for the drawer */
        .drawer-backdrop {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 40;
        }

        .drawer-backdrop.open {
            display: block;
        }

        /* Hide elements on desktop */
        @media (min-width: 768px) {
            .mobile-only {
                display: none;
            }
        }
    </style>
</head>
<body class="bg-slate-900 text-gray-200 min-h-screen flex flex-col">

    <nav class="bg-slate-800 p-4 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center relative">
            <a href="{% url 'aiapp:home' %}" class="text-2xl font-bold text-indigo-500">LearnFlow AI</a>

            <button id="mobile-menu-button" class="text-gray-400 focus:outline-none md:hidden" aria-label="Toggle mobile menu">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu">
                    <line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>
                </svg>
            </button>

            <div id="nav-links" class="hidden md:flex items-center md:space-x-6">
                <a href="{% url 'video:video_list' %}" class="text-gray-300 hover:text-white transition-colors">Videos</a>
                <a href="{% url 'aiapp:quiz_list' %}" class="text-gray-300 hover:text-white transition-colors">Quizzes</a>
                <a href="{% url 'book:book_list' %}" class="text-gray-300 hover:text-white transition-colors">Books</a>
                
                {% if user.is_authenticated %}
                <a href="{% url 'aiapp:teacher_quiz_dashboard' %}" class="text-gray-300 hover:text-white transition-colors">My Dashboard</a>
                <a href="{% url 'aiapp:create_quiz' %}" class="text-gray-300 hover:text-white transition-colors">Create Quiz</a>
                <a href="{% url 'aiapp:user_profile' user.id %}" class="text-gray-300 hover:text-white transition-colors">My Profile</a>
                
                <form action="{% url 'user:logout' %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="px-4 py-2 bg-rose-600 text-white rounded-full hover:bg-rose-700 transition-colors shadow-sm font-semibold">
                        Logout
                    </button>
                </form>
                {% else %}
                <a href="{% url 'user:login' %}" class="px-4 py-2 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 transition-colors shadow-sm font-semibold">
                    Login
                </a>
                {% endif %}
            </div>
        </div>
    </nav>
    
    <div id="mobile-drawer-backdrop" class="drawer-backdrop mobile-only"></div>
    <div id="mobile-drawer" class="fixed top-0 right-0 h-full w-3/4 bg-slate-800 shadow-xl p-6 z-50 transform translate-x-full transition-transform ease-out duration-300 mobile-only">
        <div class="flex justify-end mb-4">
            <button id="close-drawer-button" class="text-gray-400 hover:text-white focus:outline-none">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            </button>
        </div>
        <div class="space-y-4">
            <a href="{% url 'video:video_list' %}" class="flex items-center text-lg text-gray-300 hover:text-white transition-colors space-x-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-play-circle"><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8"/></svg>
                <span>Videos</span>
            </a>
            <a href="{% url 'aiapp:quiz_list' %}" class="flex items-center text-lg text-gray-300 hover:text-white transition-colors space-x-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard-list"><rect width="8" height="4" x="8" y="2"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="M12 11h4"/><path d="M12 16h4"/><path d="M8 11h.01"/><path d="M8 16h.01"/></svg>
                <span>Quizzes</span>
            </a>
            <a href="{% url 'book:book_list' %}" class="flex items-center text-lg text-gray-300 hover:text-white transition-colors space-x-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-text"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/><path d="M8 8h6"/><path d="M8 12h8"/></svg>
                <span>Books</span>
            </a>
        </div>
        
        {% if user.is_authenticated %}
        <div class="mt-8 pt-6 border-t border-slate-700 space-y-4">
            <a href="{% url 'aiapp:teacher_quiz_dashboard' %}" class="flex items-center text-lg text-gray-300 hover:text-white transition-colors space-x-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-layout-dashboard"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>
                <span>My Dashboard</span>
            </a>
            <a href="{% url 'aiapp:create_quiz' %}" class="flex items-center text-lg text-gray-300 hover:text-white transition-colors space-x-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-plus"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="12" x2="12" y1="18" y2="12"/><line x1="9" x2="15" y1="15" y2="15"/></svg>
                <span>Create Quiz</span>
            </a>
            <a href="{% url 'aiapp:user_profile' user.id %}" class="flex items-center text-lg text-gray-300 hover:text-white transition-colors space-x-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user-circle"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="10" r="3"/><path d="M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"/></svg>
                <span>My Profile</span>
            </a>
            
            <form action="{% url 'user:logout' %}" method="post">
                {% csrf_token %}
                <button type="submit" class="w-full px-4 py-3 bg-rose-600 text-white rounded-full hover:bg-rose-700 transition-colors shadow-sm font-semibold text-center mt-4">
                    Logout
                </button>
            </form>
        </div>
        {% else %}
        <div class="mt-8 pt-6 border-t border-slate-700">
            <a href="{% url 'user:login' %}" class="w-full px-4 py-3 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 transition-colors shadow-sm font-semibold text-center block">
                Login
            </a>
        </div>
        {% endif %}
    </div>

    <main class="container mx-auto p-4 flex-grow">
        {% if messages %}
            <div class="mb-4">
                {% for message in messages %}
                    <div class="p-3 mb-2 rounded-md font-medium text-sm {% if message.tags %}bg-{{ message.tags }}-800 text-{{ message.tags }}-300{% else %}bg-green-800 text-green-300{% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        {% block content %}
        {% endblock %}
    </main>
    
    <script>
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileDrawer = document.getElementById('mobile-drawer');
        const closeDrawerButton = document.getElementById('close-drawer-button');
        const mobileDrawerBackdrop = document.getElementById('mobile-drawer-backdrop');

        function openDrawer() {
            mobileDrawer.classList.add('open');
            mobileDrawerBackdrop.classList.add('open');
            document.body.style.overflow = 'hidden'; // Prevents scrolling
        }

        function closeDrawer() {
            mobileDrawer.classList.remove('open');
            mobileDrawerBackdrop.classList.remove('open');
            document.body.style.overflow = ''; // Re-enables scrolling
        }

        mobileMenuButton.addEventListener('click', openDrawer);
        closeDrawerButton.addEventListener('click', closeDrawer);
        mobileDrawerBackdrop.addEventListener('click', closeDrawer);
    </script>
</body>
</html>