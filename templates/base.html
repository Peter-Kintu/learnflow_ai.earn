<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}LearnFlow AI{% endblock %}</title>
    <!-- Use Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style for the responsive menu button */
        #mobile-menu-button {
            display: none;
        }
        @media (max-width: 768px) {
            #mobile-menu-button {
                display: block;
            }
            #nav-links {
                display: none;
            }
            #nav-links.active {
                display: flex;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background-color: #1e293b; /* slate-800 */
                padding: 1rem 0;
                border-top: 1px solid #334155; /* slate-700 */
            }
        }
    </style>
</head>
<body class="bg-slate-900 text-gray-200 min-h-screen flex flex-col">

    <!-- Navigation Bar -->
    <nav class="bg-slate-800 p-4 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center relative">
            <!-- Logo/Home Link -->
            <!-- Updated the URL to point to the 'aiapp' home page -->
            <a href="{% url 'aiapp:home' %}" class="text-2xl font-bold text-indigo-500">LearnFlow AI</a>

            <!-- Mobile Menu Button -->
            <button id="mobile-menu-button" class="text-gray-400 focus:outline-none">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu">
                    <line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>
                </svg>
            </button>

            <!-- Nav Links (Desktop) -->
            <div id="nav-links" class="md:flex items-center space-x-6">
                <!-- Links for all users -->
                <a href="{% url 'video:video_list' %}" class="text-gray-300 hover:text-white transition-colors">Videos</a>
                <a href="{% url 'aiapp:quiz_list' %}" class="text-gray-300 hover:text-white transition-colors">Quizzes</a>
                <!-- New button for the books app -->
                <a href="{% url 'book:book_list' %}" class="text-gray-300 hover:text-white transition-colors">Books</a>
                
                {% if user.is_authenticated %}
                    <!-- Links for authenticated users -->
                    <a href="{% url 'video:teacher_dashboard' %}" class="text-gray-300 hover:text-white transition-colors">My Dashboard</a>
                    <a href="{% url 'aiapp:create_quiz' %}" class="text-gray-300 hover:text-white transition-colors">Create Quiz</a>
                    <a href="{% url 'aiapp:user_profile' user.id %}" class="text-gray-300 hover:text-white transition-colors">My Profile</a>
                    
                    <!-- FIX: Changed the logout link to a form with a POST method -->
                    <form action="{% url 'user:logout' %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="px-4 py-2 bg-rose-600 text-white rounded-full hover:bg-rose-700 transition-colors shadow-sm font-semibold">
                            Logout
                        </button>
                    </form>
                {% else %}
                    <!-- Links for non-authenticated users -->
                    <a href="{% url 'user:login' %}" class="px-4 py-2 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 transition-colors shadow-sm font-semibold">
                        Login
                    </a>
                {% endif %}
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="container mx-auto p-4 flex-grow">
        <!-- Message Display Area -->
        {% if messages %}
            <div class="mb-4">
                {% for message in messages %}
                    <div class="p-3 mb-2 rounded-md font-medium text-sm {% if message.tags %}bg-{{ message.tags }}-800 text-{{ message.tags }}-300{% else %}bg-green-800 text-green-300{% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        {% block content %}
        <!-- Content from other templates will be inserted here -->
        {% endblock %}
    </main>

    <script>
        // JavaScript for mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const navLinks = document.getElementById('nav-links');

        mobileMenuButton.addEventListener('click', () => {
            navLinks.classList.toggle('active');
        });
    </script>
</body>
</html>
